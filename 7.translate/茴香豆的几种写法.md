# 茴香豆的几种写法

今天遇到一个问题，在部分安卓手机上，人民币符号没有按照预期渲染。
期望的是`¥`, 但实际渲染成 `Ұ`

## 问题原因

问题的原因可能是：

1. 设备使用的字体不支持全量的unicode编码
2. 字体和设备操作系统或应用有兼容性问题

`¥`字符本质上说是一个汉字，如果在使用的字体库中，没有正确的匹配到（原因如上述两条），就可能导致降级使用类似符号，比如`Ұ`

还有其他说法是，全角和半角的问题，其实我理解本质上就是字符编码的问题，全角一般是在中文体系内，也就是说你使用中文输入法打了一个`¥`； 对应到深层原因，就是在字符编码匹配字体的时候，没有找到正确的结果。

## 解决方案

解决方案总体来说就是使用 `HTML实体（HTML Entity）`

### HTML Entity

HTML Entity 是用来展示那些保留字符、不可见字符、或者是不易输入的字符

比如`<`字符，在HTML内常见的是作为标签的开始标示，但是如果说我确实就想在页面中展示`<`; 这时候就可以使用HTML Entity。

'<' === &#60; === &#x3c; === &lt;

如上：HTML Entity 是以`&`开头, 以`;`结束的一个字符串

> 注意`;`也是实体的一部分

并且有多种写法

1. `&#<十进制实体数>;`
2. `&#x<十六进制实体数>;`
3. `&<别名>` 不是所有的实体都有这个别名，这个主要是方便记忆

刚好`¥`有对应的HTML实体，

`¥` === `&#165;` === `&#xa5;` === `&yen;`

`&#165;` `&#xa5;` `&yen;` 这些在HTML中都会被渲染成`¥`;

### Unicode

在unicode中， 码点为`65509`的字符，也是一个`￥`

因此在HTML中，按照HTML实体的写法， &#65509; 和 &#xFFE5; 视觉上也是会被渲染成`￥`

但有一点区别是 它占用的更大的宽度，具体来说，就是上述字符占用的宽度的2倍。

因此，你可以很容易的联想到，这其实是一个全角字符，而上述三个对应的是半角字符。

### 总结

从表面上看，HTML Entity和Unicode两种方法的写法是一致的，

并且半角`¥`符号在unicode字符集中的码点，刚好也是`165`

这个现象，会让人疑惑，到底HTML Entity与Unicode是有什么特殊关系吗？  难道所有的Unicode都是一个HTML Entity吗？

最终，我的思考结论是：

1. HTML Entity 是一个独立的概念，有一个官方的版本清单，罗列了有限的特殊字符
2. HTML Entity 包括 ASCCI 字符集中的可见部分
   1. ASCCI 字符集中包含半角`¥`
   2. Unicode复用了ASCCI字符集编码
   3. 所以这些字符的HTML实体码与Unicode码点是一致的
3. 并不是所有的Unicode都是一个HTML Entity
   1. 但是Unicode可以用在HTML中，使用方式就是HTML Entity的写法

## 最后

最后，几种写法在页面上的展示效果

![WechatIMG228.png](https://s2.loli.net/2023/03/08/kGfVbTjdmDqp5PY.png)
