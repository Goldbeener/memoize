<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
        html,
        body {
            margin: 0;
            padding: 0
        }

        .hash {
            width: 100px;
            height: 60px;
            background-color: lightblue;
            position: fixed;
            left: 50px;
            top: 40px;
        }

        .circle {
            width: 200px;
            height: 200px;
            background-color: #f60;
            border-radius: 50%;
            position: fixed;
            border: solid;
            border-color: red;
            border-width: 20px;
            left: 0;
            top: 0;
            transform: translate(-20px, -50px);
        }
    </style>
</head>

<body>
    <h1>testststt</h1>
    <div class="circle"></div>
    <div class="hash"></div>
    <button type="button" id="btn">æŒ‰é’®</button>
    <script src="./js/request-queue.js" type="text/javascript"></script>
    <script type="text/javascript">
        const btn = document.getElementById("btn");
        btn.onclick = function () {
            const xhr = new XMLHttpRequest();
            xhr.open('POST', '/api/xhr');
            xhr.setRequestHeader('Content-Type', 'application/json');
            xhr.responseType = 'json';
            xhr.withCredentials = true;

            // è¯·æ±‚è¢«åŽç«¯å¤„ç†å®Œæˆ
            xhr.onload = function () {
                if (xhr.status === 200) {
                    // success
                    console.log('>>>>', xhr.response);
                } else {
                    // æœåŠ¡å™¨å¤„ç†äº†ä½†æ˜¯å¤±è´¥äº†
                }
            };
            xhr.onerror = function () {
                console.log('ç½‘ç»œé”™è¯¯æˆ–è€…æ˜¯è·¨åŸŸè¢«æ‹¦æˆª');
            };

            xhr.send(JSON.stringify({ foo: 'bar' }));
        };

        // let progress = 0;
        // fetch('/')
        //     .then(res => {
        //         const contentLength = res.headers.get('Content-Length');
        //         const pump = function (reader) {
        //             return reader.read().then(result => {
        //                 if (result.done) {
        //                     return
        //                 }
        //                 const chunk = result.value;

        //                 progress += chunk.byteLength;
        //                 console.log((progress / contentLength * 100).toFixed(2) + '%');

        //                 return pump(reader)
        //             })
        //         }
        //         return pump(res.body.getReader())
        //     }).catch(e => {
        //         console.log('ðŸš€ðŸš€ðŸš€ ~ e', e);
        //     })
    </script>
</body>

</html>